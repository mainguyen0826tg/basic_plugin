import { __read } from "tslib";
// (C) 2021 GoodData Corporation
import React, { useCallback, useMemo, useState } from "react";
import { DateFilter } from "@gooddata/sdk-ui-filters";
import { dateFilterOptionToDashboardDateFilter } from "../../../_staging/dashboard/dashboardFilterConverter";
import { matchDateFilterToDateFilterOptionWithPreference } from "../../../_staging/dateFilterConfig/dateFilterOptionMapping";
import { selectLocale, selectSettings, useDashboardSelector } from "../../../model";
/**
 * Default implementation of the attribute filter to use on the dashboard's filter bar.
 *
 * This will use the SDK's DateFilter with the button styled same as we have it today on KD.
 *
 * @alpha
 */
export var DefaultDashboardDateFilter = function (props) {
    var settings = useDashboardSelector(selectSettings);
    var locale = useDashboardSelector(selectLocale);
    var filter = props.filter, onFilterChanged = props.onFilterChanged, config = props.config, readonly = props.readonly;
    var _a = __read(useState(""), 2), lastSelectedOptionId = _a[0], setLastSelectedOptionId = _a[1];
    var _b = useMemo(function () {
        return matchDateFilterToDateFilterOptionWithPreference(filter, config.dateFilterOptions, lastSelectedOptionId);
    }, [filter, config.dateFilterOptions, lastSelectedOptionId]), dateFilterOption = _b.dateFilterOption, excludeCurrentPeriod = _b.excludeCurrentPeriod;
    var onApply = useCallback(function (option, exclude) {
        setLastSelectedOptionId(option.localIdentifier);
        onFilterChanged(dateFilterOptionToDashboardDateFilter(option, exclude), option.localIdentifier);
    }, [onFilterChanged]);
    return (React.createElement(DateFilter, { excludeCurrentPeriod: excludeCurrentPeriod, selectedFilterOption: dateFilterOption, dateFilterMode: readonly ? "readonly" : "active", filterOptions: config.dateFilterOptions, availableGranularities: config.availableGranularities, customFilterName: config.customFilterName, onApply: onApply, dateFormat: settings.responsiveUiDateFormat, locale: locale }));
};
//# sourceMappingURL=DefaultDashboardDateFilter.js.map