import { __assign } from "tslib";
import omit from "lodash/omit";
/**
 * Specifies props that are on bucket chart props but not on core chart props - these must not be passed
 * down to core chart.
 */
var NON_CORE_PROPS = ["backend", "workspace"];
export var getCoreChartProps = function (chart) {
    return function (props) {
        var propsToUse = chart.propTransformation ? chart.propTransformation(props) : props;
        if (chart.onBeforePropsConversion) {
            chart.onBeforePropsConversion(propsToUse);
        }
        var buckets = chart.bucketsFactory(propsToUse);
        var execution = chart.executionFactory(propsToUse, buckets);
        var nonBucketProps = omit(propsToUse, chart.bucketPropsKeys);
        var propOverrides = chart.propOverridesFactory
            ? chart.propOverridesFactory(propsToUse, buckets)
            : {};
        var exportTitle = propsToUse.exportTitle || chart.chartName;
        var coreChartProps = __assign(__assign(__assign({}, nonBucketProps), propOverrides), { execution: execution,
            exportTitle: exportTitle });
        return omit(coreChartProps, NON_CORE_PROPS);
    };
};
//# sourceMappingURL=chartDefinition.js.map