// (C) 2021 GoodData Corporation
import { insightsAdapter } from "./insightsEntityAdapter";
import { createSelector } from "@reduxjs/toolkit";
import { insightRef } from "@gooddata/sdk-model";
import { newInsightMap } from "../../../_staging/metadata/objRefMap";
import { selectBackendCapabilities } from "../backendCapabilities/backendCapabilitiesSelectors";
import { createMemoizedSelector } from "../_infra/selectors";
var entitySelectors = insightsAdapter.getSelectors(function (state) { return state.insights; });
/**
 * Selects all insights used on the dashboard.
 *
 * Note: if you are aiming to lookup insights using an ObjRef, then you should instead use the map returned
 * by {@link selectInsightsMap}. If you are aiming to lookup a single insight by its ref, use {@link selectInsightByRef}.
 * Using these selectors is both faster and safer as they take ObjRef type into account and look up the insight
 * depending on the type of the ref.
 *
 * @remarks see {@link selectInsightsMap} or {@link selectInsightByRef} for a faster and safer ways to get
 * an insight by its ObjRef.
 * @public
 */
export var selectInsights = entitySelectors.selectAll;
/**
 * Selects refs of all insights used on the dashboard.
 *
 * @alpha
 */
export var selectInsightRefs = createSelector(selectInsights, function (insights) {
    return insights.map(insightRef);
});
/**
 * Selects all insights and returns them in a mapping of obj ref to the insight object.
 *
 * @alpha
 */
export var selectInsightsMap = createSelector(selectInsights, selectBackendCapabilities, function (insights, capabilities) {
    return newInsightMap(insights, capabilities.hasTypeScopedIdentifiers);
});
/**
 * Selects insight used on a dashboard by its ref.
 *
 * @alpha
 */
export var selectInsightByRef = createMemoizedSelector(function (ref) {
    return createSelector(selectInsightsMap, function (insights) {
        return ref && insights.get(ref);
    });
});
//# sourceMappingURL=insightsSelectors.js.map