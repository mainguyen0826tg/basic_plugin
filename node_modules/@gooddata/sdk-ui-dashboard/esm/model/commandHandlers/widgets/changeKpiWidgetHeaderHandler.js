import { __generator } from "tslib";
import { selectWidgetsMap } from "../../store/layout/layoutSelectors";
import { put, select } from "redux-saga/effects";
import { validateExistingKpiWidget } from "./validation/widgetValidations";
import { layoutActions } from "../../store/layout";
import { kpiWidgetHeaderChanged } from "../../events/kpi";
export function changeKpiWidgetHeaderHandler(ctx, cmd) {
    var header, correlationId, widgets, kpiWidget;
    return __generator(this, function (_a) {
        switch (_a.label) {
            case 0:
                header = cmd.payload.header, correlationId = cmd.correlationId;
                return [4 /*yield*/, select(selectWidgetsMap)];
            case 1:
                widgets = _a.sent();
                kpiWidget = validateExistingKpiWidget(widgets, cmd, ctx);
                return [4 /*yield*/, put(layoutActions.replaceWidgetHeader({
                        ref: kpiWidget.ref,
                        header: header,
                        undo: {
                            cmd: cmd,
                        },
                    }))];
            case 2:
                _a.sent();
                return [2 /*return*/, kpiWidgetHeaderChanged(ctx, kpiWidget.ref, header, correlationId)];
        }
    });
}
//# sourceMappingURL=changeKpiWidgetHeaderHandler.js.map