// (C) 2019-2021 GoodData Corporation
import React from "react";
import { objRefToString } from "@gooddata/sdk-model";
import { Bubble, ItemsWrapper } from "@gooddata/sdk-ui-kit";
import { stringUtils } from "@gooddata/util";
import { widgetRef } from "@gooddata/sdk-backend-spi";
import { LegacyInsightMenuItem } from "./LegacyInsightMenuItem";
import { DOWNLOADER_ID } from "../../../../../_staging/fileUtils/downloadFile";
var alignPoints = [{ align: "bc tr", offset: { x: 2, y: 0 } }];
var ignoredOutsideClickClasses = ["#" + DOWNLOADER_ID];
export var LegacyInsightMenu = function (_a) {
    var widget = _a.widget, items = _a.items, onClose = _a.onClose;
    var widgetRefValue = widgetRef(widget);
    var exportWidgetRefAsString = objRefToString(widgetRefValue);
    return (React.createElement(Bubble, { alignTo: ".s-dash-item-action-options-" + stringUtils.simplifyText(exportWidgetRefAsString), alignPoints: alignPoints, className: "bubble-light options-menu-bubble s-options-menu-bubble", closeOnOutsideClick: true, 
        // we need to ignore the "clicks" on the hidden downloader link to prevent the menu from closing
        // when the download starts (if the user opened it again before the download was ready)
        ignoreClicksOnByClass: ignoredOutsideClickClasses, onClose: onClose },
        React.createElement(ItemsWrapper, { smallItemsSpacing: true }, items.map(function (item) {
            // legacy menu does not support separators
            if (item.type !== "button") {
                return null;
            }
            return (React.createElement(LegacyInsightMenuItem, { key: item.itemId, bubbleId: item.itemId, bubbleMessage: item.tooltip, className: item.className, isDisabled: item.disabled, title: item.itemName, onClick: item.onClick }));
        }))));
};
//# sourceMappingURL=index.js.map